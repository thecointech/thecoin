import { TheCoinL2Instance } from '../types/TheCoinL2';

// It seems the types for deployProxy don't match the types
// generated by typechain.  We use require to strip the
// typing from OZ, as the function seems to work fine anyway
const { deployProxy } = require('@openzeppelin/truffle-upgrades');

export async function getContractL2(deployer: Truffle.Deployer, tcAddress: string) {
  const L2Contract = artifacts.require("TheCoinL2");
  // Create with minter assigned.
  // ChildChainManager calls the deposit function on the polygon chain
  // See https://static.matic.network/network/testnet/mumbai/index.json
  const childChainManager_mumbai = '0xb5505a6d998549090530911180f38aC5130101c6';
  const proxy = await deployProxy(L2Contract, [tcAddress, childChainManager_mumbai], { deployer }) as TheCoinL2Instance;
  return proxy;
}
