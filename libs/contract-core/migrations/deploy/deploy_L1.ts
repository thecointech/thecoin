import { TheCoinL1Instance } from '../types/TheCoinL1';

// It seems the types for deployProxy don't match the types
// generated by typechain.  We use require to strip the
// typing from OZ, as the function seems to work fine anyway
const { deployProxy } = require('@openzeppelin/truffle-upgrades');

export async function getContractL1(deployer: Truffle.Deployer, tcAddress: string) {
  // Create with minter assigned.
  const L1Contract = artifacts.require("TheCoinL1");
  // The address of the Goerli bridge contract
  // see MintableERC721PredicateProxy https://static.matic.network/network/testnet/mumbai/index.json
  const goerliPredicate = '0x37c3bfC05d5ebF9EBb3FF80ce0bd0133Bf221BC8';
  const proxy = await deployProxy(L1Contract, [tcAddress, goerliPredicate], { deployer }) as TheCoinL1Instance;
  return proxy;
}
